# Проектирование баз данных с помощью CASE-средств

### Задание
1.  Спроектировать базу данных Сотрудников колледжа: определить таблицы и их   атрибуты, привести таблицы к 3 нормальной форме, задать первичные и внешние ключи, ограничения целостности, создать логическую схему базы данных  в **ErAssistant**.  При разработке модели использовать приведённую ниже постановку задачи и информацию о подразделениях колледжа.
   
2.	Создать и выполнить хранимую процедуру, позволяющую создать базу данных Сотрудников колледжа в **PostgreSQL**, в качестве входных параметров указать имя базы данных, логическое  имя файла с данными, путь к  файлу с данными, логическое  имя файла журнала транзакций, путь к  файлу журнала транзакций. 

3.  Осуществить импорт данных из файла **СотрудникиИмпорт.xls**
   
4.  Осуществить импорт данных из файла **ШтатИмпорт.csv**
   
5.  Создать диаграмму в  базе данных Сотрудников колледжа, обеспечить ссылочную целостность связанных записей, каскадное обновление и каскадное удаление связанных записей.

6.  Продемонстрировать действие ссылочной целостности, каскадного  обновления и каскадного  удаления связанных записей.

7.  Создать и выполнить хранимую процедуру, позволяющую выбрать отделы с заданным количества штатных сотрудников, которое ввести в качестве параметра.

8.  Создать и выполнить хранимую процедуру, позволяющую выбрать сотрудников, которые работают на заданной должности, в заданном отделе, название  должности и название отдела ввести в качестве параметра.  
9.  
### Выполнение

1. Задание 
   + Имея следующие столбцы создадим логическую схему:
    
        |Номер|ФИО|Пол|ДатаРождения|Телефон|Образование|НазваниеОтдела|
        |-|-|-|-|-|-|-|

        |КодДолжности|НазваниеДолжности|КодОтдела|ДатаПриема|ДатаУвольнения|
        |-|-|-|-|-|

        **Entities**:
        + **Employees(Сотрудник)**: Номер, **ФИО** Фамилия, Имя, Отчество, Дата Рождения, Телефон
        + **Educations**(Образования): Номер, название
        + **Departments**(Отделы): Номер, название
        + **JobTitles**(Должности): Номер, название
        + **Appointments**(Назначения): Номер, Код Сотрудника, Код Отдела, Код Должности, Дата Приема, Дата Увольнения
   + Готовая схема в **ErAssistant** [здесь](implementation/LogicScheme.erd) 
2. Не знаю как импортировать **.xls** файл, поэтому просто сделаю его **.csv**. [файл](csvСотрудникиИмпорт.csv). Далее напишем скрипт для бд:
   + создадим 5 таблиц на основе нашей логической схемы
   + Напишем процедуру, принимающуюю в качестве параметра путь к **.csv** файлу
   + В процедуре создадим таблицу в которую и импортируем вообще все нданные, не приведенные ни к какой нормальной форме
   + Чудом раскидаем их по нашим ранее созданным таблицам  

   Во время работы с импортом данных из **.csv** файла, подметил: 
   + Нельзя использовать кириллицу в названии файла
   + Также, если среди данных есть данные о дате, нужно учитывать их порядом, по типу: "день/месяц/год", "месяц/день/год" и тд. Для каждого вида записи нужно настраивать во всей сессии `datestyle`.
     + Например для такого вида даты: "месяц/день/год". Я использовал следующую конструкцию:
         ```sql
         SET datestyle = GERMAN,MDY;
         ```
